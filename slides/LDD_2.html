<!DOCTYPE html>
<html lang="fr-FR"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-a6e161b2431e1f94a14e0f5d32135a3c.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/quarto-contrib/reveal-header-1.0.0/add_header.js" defer="true"></script>
<link href="../site_libs/quarto-contrib/reveal-header-1.0.0/add_header.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/grid-htext-1.0.0/grid_htext.css" rel="stylesheet">
<script src="../site_libs/quarto-contrib/pseudocode-2.4.1/pseudocode.min.js"></script>
<link href="../site_libs/quarto-contrib/pseudocode-2.4.1/pseudocode.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.24">

  <meta name="author" content="Équipe BD">
  <meta name="dcterms.date" content="2025-10-24">
  <title>MA15E045 - Automne 2025 – BD VII: Corriger le schéma World</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-fc22af260e9e2d20ec1df9e302aeb234.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script>
  MathJax = {
    loader: {
      load: ['[tex]/boldsymbol']
    },
    tex: {
      tags: "all",
      inlineMath: [['$','$'], ['\\(','\\)']],
      displayMath: [['$$','$$'], ['\\[','\\]']],
      processEscapes: true,
      processEnvironments: true,
      packages: {
        '[+]': ['boldsymbol']
      }
    }
  };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<meta property="og:title" content="BD VII: Corriger le schéma World – MA15E045 - Automne 2025">
<meta property="og:description" content="Définition de données: Contraintes/Ingénieurie">
<meta property="og:site_name" content="MA15E045 - Automne 2025">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#1c191c" class="quarto-title-block center">
  <h1 class="title">BD VII: Corriger le schéma World</h1>
  <p class="subtitle">Définition de données: Contraintes/Ingénieurie</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Équipe BD 
</div>
        <p class="quarto-title-affiliation">
            <a href="https://u-paris.fr">LPSM Université Paris-Cité</a>
          </p>
    </div>
</div>

  <p class="date">2025-10-24</p>
</section><section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title">Plan</h2>
<ul>
<li><a href="#/revisiter-le-schéma-world" id="/toc-revisiter-le-schéma-world">Revisiter le schéma world</a></li>
<li><a href="#/contraintes-dexclusion" id="/toc-contraintes-dexclusion">Contraintes d’exclusion</a></li>
<li><a href="#/fin" id="/toc-fin">Fin</a></li>
</ul>
</nav>
</section>
<section>
<section id="revisiter-le-schéma-world" class="title-slide slide level1 center" data-background-color="#1c191c">
<h1>Revisiter le schéma world</h1>

</section>
<section id="schema-de-world" class="slide level2 center">
<h2>Schema de world</h2>

<img data-src="..\images/schema-world.png" class="r-stretch quarto-figure-center"><p class="caption">Schema World en pattes de corbeau</p></section>
<section id="conraintes-sur-la-table-country" class="slide level2 center">
<h2>Conraintes sur la table <code>country</code></h2>
<ul>
<li><p>Un pays est identifié par son <code>countrycode</code>,</p></li>
<li><p>Deux pays ne devraient pas avoir le même nom,</p></li>
<li><p>Une région ne devrait appartenir qu’à un seul continent,</p></li>
<li><p>La capitale d’un pays devrait être une ville connue dans <code>city</code>,</p></li>
<li><p>La capitale d’un pays devrait être une ville de ce pays,</p></li>
<li><p>Les capitales de deux pays différents devraient être des villes différentes,</p></li>
<li><p>…</p></li>
</ul>
<p><i class="fa-solid fa-hand-point-right" aria-label="hand-point-right"></i> Ce ne sont pas les seules contraintes possibles</p>
</section>
<section id="mise-en-œuvre-des-contraintes" class="slide level2 center">
<h2>Mise en œuvre des contraintes</h2>
<ul>
<li><p>Un pays est identifié par son <code>countrycode</code> : <code>PRIMARY KEY</code></p></li>
<li><p>Deux pays ne devraient pas avoir le même nom : <code>UNIQUE</code></p></li>
<li><p><strong>Une région ne devrait appartenir qu’à un seul continent</strong> : ??? -&gt; <code>EXCLUDE</code></p></li>
<li><p>La capitale d’un pays devrait être une ville connue dans <code>city</code> : <code>REFERENCES</code></p></li>
<li><p><strong>La capitale d’un pays devrait être une ville de ce pays</strong> : ??? -&gt; trigger</p></li>
<li><p>Les capitales de deux pays différents devraient être des villes différentes : <code>UNIQUE</code></p></li>
<li><p>Deux pays différents ne peuvent avoir le même <code>code2</code> : <code>UNIQUE</code></p></li>
</ul>
</section>
<section id="examen-du-schema-de-country" class="slide level2 center">
<h2>Examen du schema de <code>country</code></h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb1-1"><a></a><span class="op">+</span><span class="co">--------------------+---------------+-----------+</span></span>
<span id="cb1-2"><a></a>| <span class="kw">Column</span>             | <span class="kw">Type</span>          | Modifiers | </span>
<span id="cb1-3"><a></a>|<span class="co">--------------------+---------------+-----------+-</span></span>
<span id="cb1-4"><a></a>| countrycode        | <span class="dt">character</span>(<span class="dv">3</span>)  |  <span class="kw">not</span> <span class="kw">null</span> | </span>
<span id="cb1-5"><a></a>| name_country       | text          |  <span class="kw">not</span> <span class="kw">null</span> | </span>
<span id="cb1-6"><a></a>| continent          | text          |  <span class="kw">not</span> <span class="kw">null</span> | </span>
<span id="cb1-7"><a></a>| region             | text          |  <span class="kw">not</span> <span class="kw">null</span> |</span>
<span id="cb1-8"><a></a>| surfacearea        | <span class="dt">real</span>          |  <span class="kw">not</span> <span class="kw">null</span> |</span>
<span id="cb1-9"><a></a>| indepyear          | <span class="dt">smallint</span>      |           | </span>
<span id="cb1-10"><a></a>| population_country | <span class="dt">integer</span>       |  <span class="kw">not</span> <span class="kw">null</span> | </span>
<span id="cb1-11"><a></a>| lifeexpectancy     | <span class="dt">real</span>          |           | </span>
<span id="cb1-12"><a></a>| gnp                | <span class="dt">numeric</span>(<span class="dv">10</span>,<span class="dv">2</span>) |           | </span>
<span id="cb1-13"><a></a>| gnpold             | <span class="dt">numeric</span>(<span class="dv">10</span>,<span class="dv">2</span>) |           | </span>
<span id="cb1-14"><a></a>| localname          | text          |  <span class="kw">not</span> <span class="kw">null</span> | </span>
<span id="cb1-15"><a></a>| governmentform     | text          |  <span class="kw">not</span> <span class="kw">null</span> | </span>
<span id="cb1-16"><a></a>| headofstate        | text          |           | </span>
<span id="cb1-17"><a></a>| capital            | <span class="dt">integer</span>       |           | </span>
<span id="cb1-18"><a></a>| code2              | <span class="dt">character</span>(<span class="dv">2</span>)  |  <span class="kw">not</span> <span class="kw">null</span> | </span>
<span id="cb1-19"><a></a><span class="op">+</span><span class="co">--------------------+---------------+-----------+</span></span></code></pre></div><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></div>
<p><i class="fa-solid fa-hand-point-right" aria-label="hand-point-right"></i> Un schéma de table ne se réduit pas à la données des noms et domaines des colonnes.</p>
</section>
<section id="suite" class="slide level2 center">
<h2>suite</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb2-1"><a></a><span class="kw">Indexes</span>:</span>
<span id="cb2-2"><a></a>    <span class="ot">"country_pkey"</span> <span class="kw">PRIMARY</span> <span class="kw">KEY</span>, btree (countrycode)</span>
<span id="cb2-3"><a></a><span class="kw">Check</span> <span class="kw">constraints</span>:</span>
<span id="cb2-4"><a></a>    <span class="ot">"country_continent_check"</span> <span class="kw">CHECK</span> (continent <span class="op">=</span> <span class="st">'Asia'</span>:<span class="ch">:text</span> <span class="kw">OR</span> </span>
<span id="cb2-5"><a></a>                                     continent <span class="op">=</span> <span class="st">'Europe'</span>:<span class="ch">:text</span> <span class="kw">OR</span> </span>
<span id="cb2-6"><a></a>                                     continent <span class="op">=</span> <span class="st">'North America'</span>:<span class="ch">:text</span> <span class="kw">OR</span> </span>
<span id="cb2-7"><a></a>                                     continent <span class="op">=</span> <span class="st">'Africa'</span>:<span class="ch">:text</span> <span class="kw">OR</span></span>
<span id="cb2-8"><a></a>                                     continent <span class="op">=</span> <span class="st">'Oceania'</span>:<span class="ch">:text</span> <span class="kw">OR</span></span>
<span id="cb2-9"><a></a>                                     continent <span class="op">=</span> <span class="st">'Antarctica'</span>:<span class="ch">:text</span> <span class="kw">OR</span></span>
<span id="cb2-10"><a></a>                                     continent <span class="op">=</span> <span class="st">'South America'</span>:<span class="ch">:text</span>),</span>
<span id="cb2-11"><a></a><span class="kw">Foreign</span><span class="op">-</span><span class="kw">key</span> <span class="kw">constraints</span>:</span>
<span id="cb2-12"><a></a>    <span class="ot">"country_capital_fkey"</span> <span class="kw">FOREIGN</span> <span class="kw">KEY</span> (capital) <span class="kw">REFERENCES</span> city(<span class="kw">id</span>)</span></code></pre></div><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="ddl-pour-country" class="slide level2 center">
<h2>DDL pour <code>country</code></h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb3-1"><a></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> world.country (</span>
<span id="cb3-2"><a></a>    countrycode bpchar(<span class="dv">3</span>) <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb3-3"><a></a>    name_country text <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb3-4"><a></a>    continent text <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb3-5"><a></a>    region text <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb3-6"><a></a>    surfacearea float4 <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb3-7"><a></a>    indepyear int2 <span class="kw">NULL</span>,</span>
<span id="cb3-8"><a></a>    population_country int4 <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb3-9"><a></a>    lifeexpectancy float4 <span class="kw">NULL</span>,</span>
<span id="cb3-10"><a></a>    gnp <span class="dt">numeric</span>(<span class="dv">10</span>, <span class="dv">2</span>) <span class="kw">NULL</span>,</span>
<span id="cb3-11"><a></a>    gnpold <span class="dt">numeric</span>(<span class="dv">10</span>, <span class="dv">2</span>) <span class="kw">NULL</span>,</span>
<span id="cb3-12"><a></a>    localname text <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb3-13"><a></a>    governmentform text <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb3-14"><a></a>    headofstate text <span class="kw">NULL</span>,</span>
<span id="cb3-15"><a></a>    capital int4 <span class="kw">NULL</span>,</span>
<span id="cb3-16"><a></a>    code2 bpchar(<span class="dv">2</span>) <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb3-17"><a></a>    <span class="kw">CONSTRAINT</span> country_continent_check <span class="kw">CHECK</span> (((continent <span class="op">=</span> <span class="st">'Asia'</span>:<span class="ch">:text</span>) </span>
<span id="cb3-18"><a></a>    <span class="kw">OR</span> (continent <span class="op">=</span> <span class="st">'Europe'</span>:<span class="ch">:text</span>) </span>
<span id="cb3-19"><a></a>    <span class="kw">OR</span> (continent <span class="op">=</span> <span class="st">'North America'</span>:<span class="ch">:text</span>) </span>
<span id="cb3-20"><a></a>    <span class="kw">OR</span> (continent <span class="op">=</span> <span class="st">'Africa'</span>:<span class="ch">:text</span>) </span>
<span id="cb3-21"><a></a>    <span class="kw">OR</span> (continent <span class="op">=</span> <span class="st">'Oceania'</span>:<span class="ch">:text</span>)</span>
<span id="cb3-22"><a></a>    <span class="kw">OR</span> (continent <span class="op">=</span> <span class="st">'Antarctica'</span>:<span class="ch">:text</span>) </span>
<span id="cb3-23"><a></a>    <span class="kw">OR</span> (continent <span class="op">=</span> <span class="st">'South America'</span>:<span class="ch">:text</span>))),</span>
<span id="cb3-24"><a></a>    <span class="kw">CONSTRAINT</span> country_pkey <span class="kw">PRIMARY</span> <span class="kw">KEY</span> (countrycode)</span>
<span id="cb3-25"><a></a>);</span></code></pre></div><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="ajout-de-contraintes-référentielles" class="slide level2 center">
<h2>Ajout de contraintes référentielles</h2>
<ul>
<li>Une contrainte d’intégrité référentielle impose l’inclusion de l’ensemble des valeurs d’une colonne (la colone qui référence) à l’ensemble des valeurs d’une autre colonne (la colonne référencée).</li>
</ul>
<div class="fragment">
<ul>
<li>La colonne référencée est quasiment toujours la clé primaire d’une autre table. On peut alors définir la contrainte en n’indiquant que la table référencée (car la clé primaire est unique) :</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb4-1"><a></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> world.country <span class="kw">ADD</span> <span class="kw">CONSTRAINT</span> </span>
<span id="cb4-2"><a></a>  country_capital_fkey <span class="kw">FOREIGN</span> <span class="kw">KEY</span> (capital) <span class="kw">REFERENCES</span> world.city;</span></code></pre></div><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="fragment">
<ul>
<li>Si la colonne référencée n’est pas une clé primaire, elle doit vérifier une <strong>contrainte d’unicité</strong>. Il faut alors préciser le nom de la table et le nom de la colonne référencée avec cette syntaxe : <code>REFERENCES nom_table(nom_colonne)</code></li>
</ul>
</div>
</section>
<section id="gestion-de-la-mise-à-jour-ou-de-la-suppression-dun-attribut-référencé" class="slide level2 center">
<h2>Gestion de la mise à jour ou de la suppression d’un attribut référencé</h2>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>Après la définition de la contrainte <code>country_capital_fkey</code>, la mise à jour ou la suppression d’une valeur de l’attribut <code>city.id</code> référencée dans l’attribut <code>country.capital</code> est bloquée par le SGBD.</p>
</div>
</div>
</div>
<div class="fragment">
<p>On peut définir différentes actions pour les rendre possibles :</p>
<ul>
<li><code>CASCADE</code> : supprime ou met à jour en cascade les lignes qui référencent la valeur supprimée ou mise à jour.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><code>SET NULL</code> : met à <code>NULL</code> la ou les colonnes des lignes qui référencent la valeur supprimée ou mise à jour.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><code>SET DEFAULT</code> : met à leur valeur par défaut la ou les colonnes des lignes qui référencent la valeur supprimée ou mise à jour.</li>
</ul>
</div>
</section>
<section id="utilisation-de-laction-cascade" class="slide level2 center">
<h2>Utilisation de l’action <code>CASCADE</code></h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb5-1"><a></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> world.city </span>
<span id="cb5-2"><a></a>  <span class="kw">ADD</span> <span class="kw">CONSTRAINT</span> city_countrycode_fkey </span>
<span id="cb5-3"><a></a>    <span class="kw">FOREIGN</span> <span class="kw">KEY</span> (countrycode) </span>
<span id="cb5-4"><a></a>    <span class="kw">REFERENCES</span> world.country</span>
<span id="cb5-5"><a></a>    <span class="kw">ON</span> <span class="kw">DELETE</span> <span class="kw">CASCADE</span></span>
<span id="cb5-6"><a></a>    <span class="kw">ON</span> <span class="kw">UPDATE</span> <span class="kw">CASCADE</span>;</span></code></pre></div><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Si un <code>countrycode</code> est suprrimé dans la table <code>country</code>, toutes les lignes de la table <code>city</code> où ce code est présent seront supprimées, et si ces lignes sont référencées dans un autre table, les lignes qui les référencent seront elles-mêmes supprimées et ainsi de suite “en cascade”.</li>
</ul>
<div class="fragment">
<ul>
<li>Si un <code>countrycode</code> est mis à jour dans la table <code>country</code>, toutes les lignes de la table <code>city</code> où ce code est présent seront mises à jour, et si ces mises à jour sont référencées dans un autre table, les lignes qui les référencent seront elles-mêmes mises à jour et ainsi de suite “en cascade”.</li>
</ul>
</div>
</section>
<section id="utilisation-de-laction-set-null" class="slide level2 center">
<h2>Utilisation de l’action <code>SET NULL</code></h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb6-1"><a></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> world.city </span>
<span id="cb6-2"><a></a>  <span class="kw">ADD</span> <span class="kw">CONSTRAINT</span> country_capital_fkey </span>
<span id="cb6-3"><a></a>    <span class="kw">FOREIGN</span> <span class="kw">KEY</span> (capital) </span>
<span id="cb6-4"><a></a>    <span class="kw">REFERENCES</span> world.city(<span class="kw">id</span>)</span>
<span id="cb6-5"><a></a>    <span class="kw">ON</span> <span class="kw">DELETE</span> <span class="kw">SET</span> <span class="kw">NULL</span></span>
<span id="cb6-6"><a></a>    <span class="kw">ON</span> <span class="kw">UPDATE</span> <span class="kw">CASCADE</span>;</span></code></pre></div><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Si un <code>id</code> est suprrimé dans la table <code>city</code>, les lignes de la table <code>country</code> où ce code est présent ne seront pas supprimées, la colonne <code>capital</code> sera mise à <code>NULL</code>. Cette action est possible car la valeur <code>NULL</code> est autorisée pour la colonne <code>capital</code>.</li>
</ul>
</section></section>
<section>
<section id="contraintes-dexclusion" class="title-slide slide level1 center" data-background-color="#1c191c">
<h1>Contraintes d’exclusion</h1>

</section>
<section id="une-région-nappartient-quà-un-seul-continent" class="slide level2 center">
<h2>Une région n’appartient qu’à un seul continent</h2>
<p>Cette contrainte signifie que le résultat de la requête suivante est vide :</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb7-1"><a></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb7-2"><a></a><span class="kw">FROM</span> </span>
<span id="cb7-3"><a></a>  world.country c1 </span>
<span id="cb7-4"><a></a><span class="kw">JOIN</span> </span>
<span id="cb7-5"><a></a>  world.country c2 <span class="kw">ON</span> (c1.continent<span class="op">&lt;&gt;</span> c2.continent <span class="kw">AND</span> c1.region<span class="op">=</span>c2.region);</span></code></pre></div><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></div>
<div class="fragment">
<p>On <em>exclut</em> l’existence de deux lignes qui coïncideraient sur <code>region</code> mais pas sur <code>continent</code></p>
<p>Nous postulons l’existence d’une <strong>dépendance fonctionnelle</strong></p>
<p><span class="math display">\[\texttt{region} \longrightarrow \texttt{continent}\]</span></p>
</div>
</section>
<section id="deux-attitudes" class="slide level2 center">
<h2>Deux attitudes</h2>
<p>Dans sa forme actuelle, la table <code>country</code> de <code>world</code> contient des informations <em>redondantes</em>: on répète plusieurs fois que la région <code>Western Europe</code> est située dans le continent <code>Europe</code>.</p>
<p>Ces redondances représentent un gaspillage de mémoire (très modeste ici) et un risque pour le maintien de la cohérence de la base : chaque insertion, mise-à-jour est susceptible de mettre en défaut la dépendance fonctionnelle.</p>
<p>On peut considérer qu’il s’agit d’une <em>anomalie</em> de schéma et <strong>normaliser</strong> le schéma.</p>
<p>La normalisation suppose une révision du schéma. Si le schéma est muni de vues et de fonctions, il faudra éventuellement réécrire ces vues et ces fonctions.</p>
</section>
<section id="autre-possibilité-avec-une-contrainte-dexclusion" class="slide level2 center">
<h2>Autre possibilité avec une contrainte d’exclusion</h2>
<p>Avec une contrainte d’exclusion (<code>EXCLUDE</code>), on ne touchera pas au schéma, les vues et les fonctions resteront utilisables.</p>
<p>La contrainte d’exclusion permettra de maintenir la dépendance fonctionnelle.</p>
</section>
<section id="les-contraintes-dexclusion" class="slide level2 center">
<h2>Les contraintes d’exclusion</h2>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Objectifs</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Mise en place de dépendances fonctionnelles,</li>
<li>Mise en place de contraintes de non-recouvrement (données spatiales ou temporelles),</li>
<li>Mise en place de contraintes très diverses.</li>
</ul>
</div>
</div>
</div>
<!--[Documentation](https://www.postgresql.org/docs/current/ddl-constraints.html#DDL-CONSTRAINTS-EXCLUSION){target="_blank"}
-->
</section>
<section id="clause-exclude" class="slide level2 center">
<h2>Clause EXCLUDE</h2>
<p>Une clause <code>EXCLUDE</code> empêche que <em>deux</em> lignes vérifient toutes les comparaisons sur les colonnes spécifiées en utilisant les opérateurs indiqués par le mot clé <code>WITH</code>.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb8-1"><a></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> country</span>
<span id="cb8-2"><a></a>   <span class="kw">ADD</span> <span class="kw">CONSTRAINT</span> xcl_country_region_continent </span>
<span id="cb8-3"><a></a>      EXCLUDE <span class="kw">USING</span> GIST</span>
<span id="cb8-4"><a></a>      (</span>
<span id="cb8-5"><a></a>         region <span class="kw">WITH</span> <span class="op">=</span>, </span>
<span id="cb8-6"><a></a>         continent <span class="kw">WITH</span> <span class="op">&lt;&gt;</span></span>
<span id="cb8-7"><a></a>      );</span></code></pre></div><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></div>
<p>Cette contrainte d’exclusion empèche que deux lignes de la table <code>country</code> aient la colonne <code>region</code> égale et la colonne <code>continent</code> différente.</p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>La clause <code>USING</code> définit le type d’index utilisé pour vérifier la contrainte d’exclusion.</p>
<p>En pratique, le type d’index sera toujours <code>GiST</code> ou <code>SP-GiST</code> (<code>GIST</code> est l’acronyme de <em>Generalized Search Tree</em>).</p>
</div>
</div>
</div>
<!--
## Détails syntaxiques

```{.sql}
EXCLUDE 
  [ USING index_method ] 
  ( exclude_element WITH operator [, ... ] ) 
  index_parameters 
  [ WHERE ( predicate ) ] 
```



## Remarques 

Si tous les opérateurs spécifiés testent une égalité, ceci est équivalent à une contrainte UNIQUE bien qu'une contrainte unique ordinaire sera plus rapide. 

Néanmoins, ces contraintes d'exclusion peuvent spécifier des contraintes qui sont plus générales qu'une simple égalité. 

Vous pouvez spécifier qu'il n'y a pas deux lignes dans la table contenant des cercles de surcharge en utilisant l'opérateur &&. 

 Le(s) opérateur(s) doivent être commutatif(s).


## Mise en œuvre 

Les contraintes d'exclusion sont implantées en utilisant un *index* qui a le même nom que la contrainte, donc chaque opérateur précisé doit être associé avec une classe d'opérateurs appropriée  pour la méthode d'accès par index, nommée `méthode_index`. 

Chaque `élément_exclusion` définit une colonne de l'`index`, donc il peut spécifier en option une *collation*, une classe d'opérateur, des paramètres pour la classe d'opérateurs, et/ou des options de tri 

En pratique, la méthode d'accès sera toujours `GiST` ou `SP-GiST` (`GIST` est un acronyme qui renvoie 
à *Generalized Search Tree*). 


## Zoologie des index  `B-tree`, `hash`, `GIN`

Une stratégie d'indexation permet de gérer efficacement des conditions de la forme 

```{.sql}
<colonne indexée> <opérateur> <valeur de comparaison>
```

Les index de type `B-tree` sont appropriés pour les types ordonnés et les opérateurs `=`, `<=`, `=>`

Les index de type `B-tree` sont souvent utilisés pour réaliser les équi-jointures.  

## Méthodes d'accès (Index) `GiST`

GiST: une infrastructure qui permet la mise en  œuvre de différentes stratégies d'indexation. 

Les opérateurs susceptibles d'utiliser un index  GiST peuvent varier selon la stratégie d'indexation.

. . .

La distribution standard de PostgreSQL comprend des classes d'opérateurs GiST pour plusieurs types de données géométriques (bidimensionnelles), qui permettent d'effectuer des requêtes indexées à l'aide de ces opérateurs 

```{.sql}
<<   &<   &>   >>   <<|   &<|   |&>   |>>   @>   <@   ~=   &&
```
-->
<!--
## Contraintes ajoutées

```{.sql}
-- world.country foreign keys

ALTER TABLE world.country ADD CONSTRAINT 
  country_capital_fkey FOREIGN KEY (capital) REFERENCES world.city(id);

ALTER TABLE world.country ADD CONSTRAINT 
  country_fk FOREIGN KEY (continent) REFERENCES world.code_continent(continent);
```

 La contrainte `country_fk` sur `continent` remplit la même fonction que la 
contrainte `country_continent_check`

. . .

 **Conseil:** 

- Si le domaine est de grande cardinalité, utiliser une table pour représenter le domaine, 
et une contrainte référentielle
- Si le domaine est de petite cardinalité, une contrainte `CHECK` est aussi pratique (et sans doute plus efficace)

. . .

 Comment procéder pour mettre en œuvre une contrainte de domaine sur `region` ? 
-->
<!--
# Normalisation de $\texttt{country}$   {background-color="#1c191c"}


## 


La normalisation des bases de données relationnelles est une activité en soi, guidée par des principes 
codifiés et des algorithmes établis (voir [Normalisation I](/slides/DF_norm_1.qmd), [Normalisation II](/slides/DF_norm_3.qmd))

Ici, nous profitons de la simplicité du schéma `world` pour normaliser `country` à la main. 

## Éclatement de la table `country`

- Mise en place d'une table `region_continent(region, continent)`

- Émission d'une contrainte référentielle de `country` vers `region_continent`



## Préparation

```{.sql}
CREATE SCHEMA monde AUTHORIZATION superdupont ;

GRANT ALL ON SCHEMA monde TO superdupont ;

CREATE TABLE monde.code_continent AS 
       TABLE world.code_continent ;

ALTER TABLE monde.code_continent ADD CONSTRAINT 
  code_continent_pk PRIMARY KEY (codecontinent);
ALTER TABLE monde.code_continent ADD CONSTRAINT 
  code_continent_un UNIQUE (continent);
```



## Création de `region_continent`

```{.sql}
CREATE TABLE monde.region_continent AS 
  SELECT DISTINCT 
    region, continent 
  FROM 
    world.country c ;
```


La requête suivante renvoie une table vide:

```{.sql}
SELECT * 
FROM 
  monde.region_continent rc1 
JOIN 
  monde.region_continent rc2 
ON (
    rc1.region=rc2.region AND 
  rc1.continent<> rc2.continent
) ;
```



```{.sql}
ALTER TABLE monde.region_continent ADD CONSTRAINT 
    region_continent_pk PRIMARY KEY (region);

ALTER TABLE mode.region_continent ADD CONSTRAINT 
  region_continent_fk FOREIGN KEY (continent) 
  REFERENCES monde.code_continent(continent);
```


## Création de la table `monde.country`

```{.sql}
CREATE TABLE monde.country AS  
  SELECT  
    countrycode, name_country, region, surfacearea, 
    indepyear, population_country, 
    lifeexpectancy, gnp, gnpold, localname,
    governmentform, headofstate, capital,  code2            
  FROM 
    world.country ;
```

 sans colonne `continent`



## Mise en place des contraintes sur `monde.country`


```{.sql}
ALTER TABLE monde.country ADD CONSTRAINT 
  country_pk PRIMARY KEY (countrycode);

ALTER TABLE monde.country ADD CONSTRAINT 
  country_un_name UNIQUE (name_country);

ALTER TABLE monde.country ADD CONSTRAINT 
  country_un_code2 UNIQUE (code2);

ALTER TABLE monde.country ADD CONSTRAINT 
  country_un_capital UNIQUE (capital);
```

. . .

```{.sql}
ALTER TABLE monde.country ADD CONSTRAINT country_fk 
  FOREIGN KEY (region) REFERENCES monde.region_continent(region) 
  ON DELETE SET NULL 
  ON UPDATE CASCADE;
```




## Copie de `city`

```{.sql}
CREATE TABLE monde.city AS 
  TABLE world.city;
```

 On a copié le schéma a minima (sans les contraintes)


## Dans un pays plusieurs villes peuvent elles porter le même nom ?



```{.sql}
SELECT *
FROM 
  monde.city c 
JOIN 
  monde.city c2 
ON (c.name = c2.name AND 
    c.countrycode = c2.countrycode  AND 
    c.id <> c2.id) ;
```

renvoie 48 lignes 

. . .

```{.sql}
SELECT *
FROM 
  monde.city c 
JOIN 
  monde.city c2 
ON (c.name = c2.name AND 
    c.countrycode = c2.countrycode  AND
    c.district = c2.district  AND
    c.id <> c2.id) ;
```

renvoie 2 lignes 




## Existe-t-il un pays dont la capitale est dans un autre pays ?

```{.sql}
SELECT c. countrycode, c.name_country, cc.name, cc.countrycode
FROM 
  world.country c 
JOIN 
  world.city cc 
ON (c.capital = cc.id  AND 
    cc.countrycode <> c.countrycode) ;
```

renvoie 0 lignes 


##    Blocages possibles

Si 

- `city` emet une contrainte référentielle sur `country` (`countrycode`)
- `country` emet une contrainte référentielle sur `city` (`capital` $\rightarrow$ `id`)

Risque de blocage : qui précède la capitale ou le pays ? 




## Émission de la contrainte de `city` vers `country`

```{.sql}
ALTER TABLE monde.city 
  ADD CONSTRAINT city_fk FOREIGN KEY (countrycode) 
      REFERENCES monde.country(countrycode) 
  ON DELETE SET NULL ON UPDATE CASCADE;
```



## Table `countrylanguage` 

```{.sql}
CREATE TABLE monde.countrylanguage  AS 
  TABLE world.countrylanguage ;
```

. . .


```{.sql}
ALTER TABLE monde.countrylanguage 
  ADD CONSTRAINT countrylanguage_fk 
        FOREIGN KEY (countrycode) REFERENCES monde.country(countrycode) 
        ON DELETE CASCADE 
      ON UPDATE CASCADE;

ALTER TABLE monde.countrylanguage 
  ADD CONSTRAINT countrylanguage_pk 
    PRIMARY KEY ("language",countrycode);

ALTER TABLE monde.countrylanguage 
  ADD CONSTRAINT countrylanguage_check 
    CHECK (percentage <= 100.0 AND percentage >=0.0 );
```

-->
<!-- ![](/images//bd_2023-monde.png) -->
<!--
# Les vues {background-color="#1c191c"}



## Synthèse régionale 

```{.sql}
CREATE OR REPLACE VIEW regionale AS (
SELECT C.region, 
       SUM(c.population_country) AS population_region,
       SUM(COALESCE(c.surfacearea, 0)) AS surfacearea_region,
       SUM(c.gnp) AS gnp_region,
       SUM(c.gnpold) AS gnpold_region
FROM country c 
GROUP BY c.region ) ;
```



## Synthèse continentale

```{.sql}
SELECT r.* 
FROM 
  regionale r 
JOIN 
  region_continent rc 
ON (r.region=rc.region AND rc.continent='Europe') ;
```

. . .

```{.sql}
SELECT r.* 
FROM 
  regionale r 
WHERE 
  r.region IN (
    SELECT 
      region
    FROM 
      monde.region_continent
    WHERE 
      continent='Europe'
  ) ;
```

. . .

```
+----------------+-----------------+------------------+----------+-------------+
|region          |population_region|surfacearea_region|gnp_region|gnpold_region|
+----------------+-----------------+------------------+----------+-------------+
|Western Europe  |        183247600|         1108456.5|4673272.00|   4578420.00|
|Southern Europe |        144674200|         1316392.4|2012289.00|   1944737.00|
|Baltic Countries|          7561900|          175117.0|  22418.00|     18595.00|
|Nordic Countries|         24166400|         1321901.0| 676655.00|    677698.00|
|British Islands |         63398500|          313173.0|1454251.00|   1369962.00|
|Eastern Europe  |        307026000|          18814094| 659980.00|    792589.00|
```


## Synthèse continentale

```{.sql}
CREATE OR REPLACE VIEW monde.continentale AS (
SELECT rc.continent, 
       SUM(r.population_region) AS population,
       SUM(r.surfacearea_region) AS surfacearea,
       SUM(r.gnp_region) AS gcp,
       SUM(r.gnpold_region) AS gcpold
FROM monde.regionale r JOIN monde.region_continent rc 
     ON (r.region=rc.region) 
GROUP BY rc.continent;) ;
```

. . .

```
+-------------+----------+-----------+----------+----------+
|continent    |population|surfacearea|gcp       |gcpold    |
+-------------+----------+-----------+----------+----------+
|South America| 345780000|   17864926|1511874.00|1520641.00|
|North America| 482993000|   24214472|9688627.20|9288175.00|
|Oceania      |  30401150|  8564294.0| 419774.70| 469058.00|
|Antarctica   |         0|   13132101|      0.00|          |
|Africa       | 784475000|   30250376| 580375.00| 553264.00|
|Europe       | 730074600|   23049132|9498865.00|9382001.00|
|Asia         |3705025700|   31881006|7655392.00|8251969.00|
```
-->
</section></section>
<section id="fin" class="title-slide slide level1 center" data-background-color="#1c191c">
<h1>Fin</h1>


<div class="reveal-header">
<div class="header-logo" data-header-logo-link="https://u-paris.fr">
<img data-src="..\images/logo.png">
</div>
<div class="sc-title">
<p> </p>
</div>
<div class="header-text">
<p>Compléter les contraintes d’un schéma</p>
</div>
<div class="sb-title">
<p> </p>
</div>
</div>
</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../images/UniversiteParis_monogramme_couleur_RVB.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="http://bgentou.github.io/MA15E045">MA15E045</a> – Bases de Données – L3 MIASHS – UParis Cité</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'bottom-right',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: true,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'default',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copié");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copié");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/bgentou\.github\.io\/MA15E045\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
                // target, if specified
                link.setAttribute("target", "_blank");
                if (link.getAttribute("rel") === null) {
                  link.setAttribute("rel", "noopener");
                }
                // default icon
                link.classList.add("external");
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
            let selectedAnnoteEl;
            const selectorForAnnotation = ( cell, annotation) => {
              let cellAttr = 'data-code-cell="' + cell + '"';
              let lineAttr = 'data-code-annotation="' +  annotation + '"';
              const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
              return selector;
            }
            const selectCodeLines = (annoteEl) => {
              const doc = window.document;
              const targetCell = annoteEl.getAttribute("data-target-cell");
              const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
              const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
              const lines = annoteSpan.getAttribute("data-code-lines").split(",");
              const lineIds = lines.map((line) => {
                return targetCell + "-" + line;
              })
              let top = null;
              let height = null;
              let parent = null;
              if (lineIds.length > 0) {
                  //compute the position of the single el (top and bottom and make a div)
                  const el = window.document.getElementById(lineIds[0]);
                  top = el.offsetTop;
                  height = el.offsetHeight;
                  parent = el.parentElement.parentElement;
                if (lineIds.length > 1) {
                  const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                  const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                  height = bottom - top;
                }
                if (top !== null && height !== null && parent !== null) {
                  // cook up a div (if necessary) and position it 
                  let div = window.document.getElementById("code-annotation-line-highlight");
                  if (div === null) {
                    div = window.document.createElement("div");
                    div.setAttribute("id", "code-annotation-line-highlight");
                    div.style.position = 'absolute';
                    parent.appendChild(div);
                  }
                  div.style.top = top - 2 + "px";
                  div.style.height = height + 4 + "px";
                  div.style.left = 0;
                  let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                  if (gutterDiv === null) {
                    gutterDiv = window.document.createElement("div");
                    gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                    gutterDiv.style.position = 'absolute';
                    const codeCell = window.document.getElementById(targetCell);
                    const gutter = codeCell.querySelector('.code-annotation-gutter');
                    gutter.appendChild(gutterDiv);
                  }
                  gutterDiv.style.top = top - 2 + "px";
                  gutterDiv.style.height = height + 4 + "px";
                }
                selectedAnnoteEl = annoteEl;
              }
            };
            const unselectCodeLines = () => {
              const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
              elementsIds.forEach((elId) => {
                const div = window.document.getElementById(elId);
                if (div) {
                  div.remove();
                }
              });
              selectedAnnoteEl = undefined;
            };
              // Handle positioning of the toggle
          window.addEventListener(
            "resize",
            throttle(() => {
              elRect = undefined;
              if (selectedAnnoteEl) {
                selectCodeLines(selectedAnnoteEl);
              }
            }, 10)
          );
          function throttle(fn, ms) {
          let throttle = false;
          let timer;
            return (...args) => {
              if(!throttle) { // first call gets through
                  fn.apply(this, args);
                  throttle = true;
              } else { // all the others get throttled
                  if(timer) clearTimeout(timer); // cancel #2
                  timer = setTimeout(() => {
                    fn.apply(this, args);
                    timer = throttle = false;
                  }, ms);
              }
            };
          }
            const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
            for (let i=0; i<annoteTargets.length; i++) {
              const annoteTarget = annoteTargets[i];
              const targetCell = annoteTarget.getAttribute("data-target-cell");
              const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
              const contentFn = () => {
                const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
                if (content) {
                  const tipContent = content.cloneNode(true);
                  tipContent.classList.add("code-annotation-tip-content");
                  return tipContent.outerHTML;
                }
              }
              const config = {
                allowHTML: true,
                content: contentFn,
                onShow: (instance) => {
                  selectCodeLines(instance.reference);
                  instance.reference.classList.add('code-annotation-active');
                  window.tippy.hideAll();
                },
                onHide: (instance) => {
                  unselectCodeLines();
                  instance.reference.classList.remove('code-annotation-active');
                },
                maxWidth: 300,
                delay: [50, 0],
                duration: [200, 0],
                offset: [5, 10],
                arrow: true,
                appendTo: function(el) {
                  return el.parentElement.parentElement.parentElement;
                },
                interactive: true,
                interactiveBorder: 10,
                theme: 'light-border',
                placement: 'right',
                popperOptions: {
                  modifiers: [
                  {
                    name: 'flip',
                    options: {
                      flipVariations: false, // true by default
                      allowedAutoPlacements: ['right'],
                      fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                    },
                  },
                  {
                    name: 'preventOverflow',
                    options: {
                      mainAxis: false,
                      altAxis: false
                    }
                  }
                  ]        
                }      
              };
              window.tippy(annoteTarget, config); 
            }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
        <script type="text/javascript">
        (function(d) {
          d.querySelectorAll(".pseudocode-container").forEach(function(el) {
            let pseudocodeOptions = {
              indentSize: el.dataset.indentSize || "1.2em",
              commentDelimiter: el.dataset.commentDelimiter || "//",
              lineNumber: el.dataset.lineNumber === "true" ? true : false,
              lineNumberPunc: el.dataset.lineNumberPunc || ":",
              noEnd: el.dataset.noEnd === "true" ? true : false,
              titlePrefix: el.dataset.captionPrefix || "Algorithm"
            };
            pseudocode.renderElement(el.querySelector(".pseudocode"), pseudocodeOptions);
          });
        })(document);
        (function(d) {
          d.querySelectorAll(".pseudocode-container").forEach(function(el) {
            let captionSpan = el.querySelector(".ps-root > .ps-algorithm > .ps-line > .ps-keyword")
            if (captionSpan !== null) {
              let captionPrefix = el.dataset.captionPrefix + " ";
              let captionNumber = "";
              if (el.dataset.pseudocodeNumber) {
                captionNumber = el.dataset.pseudocodeNumber + " ";
                if (el.dataset.chapterLevel) {
                  captionNumber = el.dataset.chapterLevel + "." + captionNumber;
                }
              }
              captionSpan.innerHTML = captionPrefix + captionNumber;
            }
          });
        })(document);
        </script>
      
    

</body></html>