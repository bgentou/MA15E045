{
  "hash": "d44820d52fdf95bbf230eb1a347e4dac",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"TD 1 : Algèbre relationnelle\"\ncategories: [Algèbre relationnelle, world, psql, pgcli, SQL]\nsubtitle: \"Logistique et Algèbre relationnelle\"\ndate: \"2025-09-26\"\n\nformat:\n  pdf:\n    output-file: td1.pdf\n    include-in-header:\n      - text: \"\\\\lhead{{\\\\sf  Base de données \\\\\\\\ TD 1}}\"\n  html:\n    output-file: td1.html\n\nengine: knitr\n---\n\n\n::: {.content-visible when-profile='solution'} \n\n::: {.callout-warning}\n\n### Avec solutions\n\n:::\n\n:::\n\n\n\n::: {layout=\"[80,20]\"}\n\n::: {#first-column}\n\n|                            |\n|:---------------------------|\n| {{< var curriculum >}}     |\n| {{< var university >}}     |\n| [Année {{< var year >}}]() |\n| {{< var homepage >}}       |\n| {{< var moodle >}}         |\n\n\n::: \n\n::: {#second-column}\n![](../images/UniversiteParis_monogramme_couleur_RVB.png){align=\"right\" style=\"size:50px;\" width=75}\n:::\n\n:::\n\n\n\n\n# Introduction\n\n## Paramétrage du client\n\nEn suivant le [guide dBeaver](/computing-dbeaver.html) :\n\n* Paramétrez la connexion au serveur dans le client dBeaver.\n\n* Utilisez l'onglet `Projet`.\n\n* Créez un sous-répertoire `tp1` dans le répertoire par défaut du projet.\n\n* Ouvrez un nouveau script dans votre projet et renommez-le en `ex1.sql`.\n\n\n## Schémas\n\nLes schémas sont une abstraction spécifique à PostgreSQL. Les schémas permettent de faire cohabiter dans une même base de données (un \"catalogue\" dans le jargon PostgreSQL) plusieurs ensembles d'informations de natures différentes.  \n\nDans ce TP, nous allons nous concentrer sur le schéma `world` qui contient des informations concernant des villes et des pays/territoires du monde entier. Au cours de ce semestre, nous serons amenés à utiliser d'autres schémas : `pagila` qui contient des informations concernant des films, ...\n\nDans dBeaver, vous pouvez lister les schémas du catalogue `bd_2023-24`, en développant la connexion  `bd_2023-24`.\n\nPuis en développant le schéma `world`, vous pouvez lister les tables qu'il contient.\n\nVous pouvez consulter la [page de présentation du schéma `world`](/schemas/schema-world.html).\n\n\n## Résolution des noms de tables et d'attributs\n\nPour résoudre les noms de tables et d'attributs, le serveur SQL utilise la syntaxe `nom_schéma.nom_table[.nom_attribut]` (rappel : les crochets signifient optionnel).\n\nPar exemple, `world.city` désigne la table `city` du schéma `world`.\n\nPour alléger cette écriture, vous pouvez utiliser le *chemin par défaut*. \n\nAfficher le chemin par défaut avec la requête SQL : `SHOW search_path ;`\n\nVous pouvez modifier ce chemin avec la requête `SET search_path TO nom_schéma1 [, nom_schéma2]`.\nIl peut y avoir plusieurs schémas dans le `search_path`.\n\nL'ordre est important. Avec `SET search_path TO world, public ;` la résolution des noms se fera d'abord dans le schéma `world` *puis en cas d'échec*, dans le schéma `public`.\n\nAprès cette instruction `city` désigne la table `city` du schéma `world` si elle existe, sinon cela désigne la table `city` du schéma `public`, sinon le serveur renverra une erreur.\n\nOn ajoute systématiquement `public` dans le `search_path`, pour permettre une bonne compatibilité car de nombreuses applications et outils s'attendent à ce que les objets (tables, vues, fonctions) soient accessibles via ce schéma.\n\n\n*Exécutez le script*\n\n```{.sql}\nSHOW search_path ;\nSET search_path TO world, public ;\nSHOW search_path ;\n```\n\n\n## Tables\n  \nPour voir le schéma d'une table avec le client dBeaver, il suffit de dérouler le schéma `world` puis de double-cliquer sur la table.\n\nVous pouvez aussi visualiser toutes les tables du schéma par un clic droit sur le schéma puis `Voir le diagramme`.\n\n[](/images/td/world/MRD_world.png){fig-align=\"center\" height=\"70%\"}\n\nDans la deuxième partie du TP, on s'intéresse aux requêtes, c'est-à-dire, les moyens d'extraire une information pertinente d'une base de données.\n\n# Écriture d'une requête\n\nPour extraire des informations d'une base de données, on utilise l'algèbre relationnelle (pour la théorie) et le langage SQL (pour la pratique).\n\nA la fin du TP, vous devez rendre sur Moodle vos fichiers scripts (a priori un par exercice). Chaque fichier contient une liste de requêtes SQL. *Lorsque c'est demandé, il faut écrire en commentaire l'expression correspondante en algèbre relationnelle*.\n\nPour écrire un commentaire en SQL : `--` en début de ligne.\n\n*NB* : pensez à documenter vos scripts en utilisant les commantaire SQL\n\n\n\n# Requêtes monotables\n<!-- L'*algèbre relationnelle* est un ensemble d'opération sur les tables. Chaque opération prend en argument une ou plusieurs tables et produit une nouvelle table. Nous commençons par introduire deux opérations importantes qui opèrent sur une table à la fois :\n\n- *Projection* : $\\pi_{\\texttt{liste de colonnes}}{R}$. Cette opération ne garde que les colonnes mentionnées de la table $R$. Par exemple $\\pi_{\\texttt{name,continent}}{\\texttt{world.country}}$ est la table avec deux colonnes `name, continent` et une ligne pour chaque ligne de la table `world.country`.\n\n- *Sélection* : $\\sigma_{\\texttt{condition}}{R}$. Cette opération ne garde que les lignes qui respectent la condition indiquée. Par exemple $\\sigma_{\\texttt{lifeexpectancy < 50}}\\texttt{world.country}$ renvoie la table contenant les pays ayant une espérance de vie de moins de 50 ans.\n\n\nCes deux opérations peuvent être écrites en SQL ainsi :\n-->\n\nOn rappele que la requête SQL\n\n```{.sql}\nSELECT colonne1, colonne2, ... \nFROM table \nWHERE condition;\n```\n\naffiche les colonnes de `table` indiquées après le `SELECT` qui respectent la `condition`. \n\nC'est la transcription de \n\n$${\\Pi}_{\\texttt{colonne1, colonne2}}\\left({\\Large \\sigma}_{\\texttt{condition}}\\left(\\texttt{table}\\right)\\right)$$\n\nPar exemple:\n\n```{.sql}\nSELECT name_country, lifeexpectancy\nFROM country\nWHERE lifeexpectancy < 50 and continent = 'Asia';\n```\n\naffichera le nom et l'espérance de vie des pays d'Asie ayant une espérance de vie inférieure à 50 ans. \n\nRemarquez l'utilisation des apostrophes simples pour délimiter les chaînes de caractères ('Asia').\n\n\n\n## Éxercice 1\n\nEcrire des requêtes en algèbre relationnelle et en SQL pour extraire les informations suivantes du schéma `world`:\n\n@. Quelles sont les régions ? (25 lignes)\n\n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n$\\Pi(\\texttt{country},\\texttt{ region} )$\n\n```{.sql}\nSELECT DISTINCT region\nFROM country ;\n```\n\n:::\n:::\n\n\n@. Quelles sont les régions situées en Europe ? (6 lignes)\n\n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n$\\Pi \\big( \\sigma(\\texttt{country},\\texttt{ continent = 'Europe'}), \\texttt{ region}\\big)$\n\n```{.sql}\nSELECT DISTINCT region\nFROM country\nWHERE continent = 'Europe' ;\n```\n\n:::\n:::\n\n\n\n@. Quels sont les pays situés en Europe du sud ('Southern Europe') ? (15 lignes)\n\n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n$\\Pi \\big( {\\Large \\sigma}(\\texttt{country},\\texttt{ region = 'Southern Europe'}),\\texttt{ name\\_country}\\big)$\n\n```{.sql}\nSELECT name_country\nFROM country\nWHERE region = 'Southern Europe' ;\n```\n\n:::\n:::\n\n\n\n@. Quelles sont les capitales des pays situés en Europe de l'Ouest ? (quel est le type de la colonne `capital` dans la table `country`?) (9 lignes)\n\n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n$\\Pi \\big({\\Large \\sigma}(\\texttt{country},\\texttt{ region = 'Western Europe'}),\\texttt{ capital}\\big)$\n\n```{.sql}\nSELECT capital\nFROM country\nWHERE region = 'Western Europe' ;\n```\n\n:::\n:::\n\n\n@. A partir de la table `countrylanguage`, quels sont les langues qui sont officielles dans au moins un pays ? (102 lignes)\n\n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n$\\Pi \\big( {\\Large \\sigma}(\\texttt{ countrylanguage},\\texttt{ isofficial}), \\texttt{ language}\\big)$\n\n```{.sql}\nSELECT DISTINCT language \nFROM countrylanguage \nWHERE isofficial ;\n```\n\nLa variante de l'algèbre relationnelle vue en cours opérant sur les ensembles, `DISTINCT` est toujours implicitement implémenté par la requête algébrique. Ce n'est pas le cas en SQL (variante multi-ensembliste de l'algèbre relationnelle), il existe donc un opérateur d'élimination des doublons : `DISTINCT`.\n\n:::\n:::\n\n\n@. Quels sont les codes des pays où le français est langue officielle ? (18 lignes) Même question pour les langues de votre choix ?\n  \n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n$\\Pi \\big( {\\Large \\sigma}(\\texttt{ countrylanguage},\\texttt{ language = 'French'} \\wedge \\texttt{ isofficial}),\\texttt{ countrycode}\\big)$\n\n```{.sql}\nSELECT countrycode\nFROM countrylanguage\nWHERE language = 'French' AND isofficial ;\n```\n\n:::\n:::\n\n\n\n@. Quelle est la date d'indépendance de la France ?\n  \n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n$\\Pi \\big( {\\Large \\sigma}(\\texttt{country},\\texttt{ countrycode = 'FRA'}),\\texttt{ indepyear}\\big)$\n\n```{.sql}\nSELECT indepyear\nFROM country\nWHERE countrycode = 'FRA' ;\n```\n\n:::\n:::\n\n\n\n@. Quelles sont les dates d'indépendance des pays d'Europe ? (46 lignes)\n  \n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n$\\Pi \\big( {\\Large \\sigma}(\\texttt{country} , \\texttt{ continent = 'Europe'}),\\texttt{ name\\_country , indepyear}\\big)$\n\n```{.sql}\nSELECT name_country , indepyear\nFROM country\nWHERE continent = 'Europe' ;\n```\n\n:::\n:::\n\n\n\n@. Quelles sont les villes françaises de plus de 200 000 habitants ? (10 lignes)\n  \n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n$\\Pi \\big( {\\Large \\sigma}(\\texttt{ city}, \\texttt{ countrycode = 'FRA'}\\wedge \\texttt{population > 200000}), \\texttt{ name , population}\\big)$\n\n```{.sql}\nSELECT name , population\nFROM city\nWHERE countrycode = 'FRA' AND population > 200000 ;\n```\n\n:::\n:::\n\n\n\n@. Pour chaque pays européen, calculer la densité, le GNP par habitant,\net l'espérance de vie, ordonner par densité décroissante. (46 lignes)\n\n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n${\\small\\texttt{R1 = }\\Pi\\big( {\\Large \\sigma}(\\texttt{country},  \\texttt{ continent='Europe'}), \\texttt{ name\\_country}, \\texttt{ population\\_country/surfacearea}},$\n\n$\\qquad {\\small \\texttt{gnp/population\\_country}, \\texttt{ lifeexpectancy}\\big)}$\n\n${\\small\\texttt{R = }{\\Large \\rho}( \\texttt{R1,} \\texttt{ population\\_country} / \\texttt{surfacearea} \\mapsto \\texttt{density}, \\texttt{gnp/population\\_country} \\mapsto \\texttt{gnp\\_per\\_hab})}$\n\n```{.sql}\nSELECT name_country , population_country / surfacearea as density ,\n       gnp / population_country as gnp_per_hab , lifeexpectancy\nFROM country \nWHERE continent = 'Europe'\nORDER BY density DESC;\n```\n\n:::\n:::\n\n\n\n@. Quels sont les pays où l'espérance de vie n'est pas inférieure à 77 ans et le pnb par habitant n'est pas supérieur à \\(0.010\\) ? (10 lignes)\n    \n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n$\\Pi \\big( {\\Large \\sigma}(\\texttt{country}, \\neg \\texttt{(lifeexpectancy<77)}\\wedge\\ \\neg \\texttt{(gnp/population\\_country>0,01)}), \\texttt{ name\\_country}\\big)$\n\nou, de manière équivalente\n\n$\\Pi \\big( \\sigma(\\texttt{country}, \\texttt{(lifeexpectancy>=77)}\\wedge \\texttt{(gnp/population\\_country<=0.01)}), \\texttt{ name\\_country}\\big)$\n\n```{.sql}\nSELECT name_country \nFROM country\nWHERE NOT (lifeexpectancy < 77) AND \n      NOT (gnp / population_country > 0.01) ;\n```\n\n:::\n:::\n\n\n\n@. Quels sont les pays tels que la condition (espérance de vie supérieure\nou égale à 77 ans ou PNB par habitant inférieur à \\(0.01\\)) n'est pas\nvérifée ? (16 lignes)\n    \n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n$\\Pi \\big( {\\Large \\sigma}(\\texttt{country}, \\neg (\\texttt{(lifeexpectancy>=77)} \\vee \\texttt{(gnp/population\\_country<0,01)})) , \\texttt{ name\\_country}\\big)$\n\nou, de manière équivalente\n\n$\\Pi \\big( \\sigma(\\texttt{country}, \\texttt{ (lifeexpectancy<77)}\\wedge \\texttt{(gnp/population\\_country >= 0.01)}), \\texttt{ name\\_country}\\big)$\n\n```{.sql}\nSELECT name_country\nFROM country\nWHERE NOT (lifeexpectancy >= 77 OR (gnp / population_country < 0.01) );\n```\n\n:::\n:::\n\n\n\n@. Quels sont les pays où une langue est officielle sans être parlée par\nau moins la moitié de la population ? (92 lignes)\n    \n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n$\\Pi \\big( {\\Large \\sigma}(\\texttt{countrylanguage}, \\texttt{ isofficial }\\wedge\\texttt{ percentage<50}), \\texttt{ countrycode}\\big)$   \n\n```{.sql}\nSELECT DISTINCT countrycode\nFROM countrylanguage\nWHERE isofficial AND percentage < 50 ;\n```\n\n:::\n:::\n\n\n\n@. Quels sont les codes des pays qui ont au moins une langue officielle ? (190 lignes)\n    \n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n$\\Pi \\big( {\\Large \\sigma}(\\texttt{countrylanguage}, \\texttt{ isofficial}), \\texttt{ countrycode}\\big)$  \n\n```{.sql}\nSELECT DISTINCT countrycode \nFROM countrylanguage \nWHERE isofficial ;\n```\n\n:::\n:::\n\n\n\n@. Quels sont les noms des pays qui comptent plus de 100 000 000\nd'habitants ? (10 lignes)\n    \n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n$\\Pi \\big( {\\Large \\sigma}(\\texttt{country}, \\texttt{ population\\_country > 100000000}), \\texttt{ name\\_country}\\big)$\n\n```{.sql}\nSELECT name_country \nFROM country\nWHERE population_country > 100000000 ;\n```\n\n:::\n:::\n\n\n\n\n\n\n# Requêtes multi-tables\n\nOn peut aussi combiner plusieurs tables. Pour ce TP, nous allons seulement présenter le produit cartésien de deux tables: $T \\times S$ est la table dont les colonnes sont les colonnes de $S$ et les colonnes de $T$ et dont les lignes sont tous les couples $(l_1,l_2)$ où $l_1$ est une ligne de $T$ et $l_2$ est une ligne de $S$. En SQL, on écrira:\n\n```{.sql}\nSELECT col1,col2 \nFROM table1,table2 \nWHERE condition;\n```\n\nPar exemple,\n\n```{.sql}\nSELECT language\nFROM country as co, countrylanguage as l\nWHERE co.countrycode = l.countrycode and co.continent = 'Europe';\n```\n\naffichera les langues parlées en Europe. Remarquez l'utilisation des `as` pour donner de nouveaux noms aux tables et l'utilisation de `co.countrycode` pour lever l'ambiguité sur des noms de colonnes qui seraient éventuellement les mêmes.\n\n## Éxercice 2\n\n\n\nEcrire des requêtes pour les questions suivantes:\n\n\n\n@. Quels sont les noms des capitales sud-américaines ? (14 lignes)\n\n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n  ${\\small \\Pi \\big( \\sigma (\\rho(\\texttt{city}, \\texttt{countrycode} \\mapsto \\texttt{city\\_countrycode}) \\bowtie_{\\texttt{capital=id}} \\texttt{country}, \\texttt{region='South America'}\\big), \\texttt{name} \\big)}$\n\nEn toute rigueur la relation qui résulte d'une opération ne peut pas contenir deux attributs de même nom, \nd'où le renommage utilisé dans la requête algébrique ci-dessus. En pratique, on suppose  que les renommages\n`attribut`$\\mapsto$`table.attribut` sont faits implicitement chaque fois que nécessaire. \n\nOn peut alors écrire plus simplement :\n\n  $\\Pi \\big( \\sigma (\\texttt{city} \\bowtie_{\\texttt{capital=id}} \\texttt{country}, \\texttt{ region='South America'}\\big), \\texttt{ name} \\big)$\n\n      \n\n\n```{.sql}\nSELECT name\nFROM country , city\nWHERE capital = id AND region = 'South America' ;\n```\n\n Il est préférable d'utiliser l'opération de jointure :\n\n```{.sql}\nSELECT name\nFROM country JOIN city ON capital = id\nWHERE region = 'South America';\n```\n\n:::\n:::\n\n\n@. Quels sont les noms des pays où le français est langue officielle ? (18 lignes)\n\n\n\n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n  ${\\small\\Pi \\big( \\sigma(\\texttt{country} \\bowtie_{\\texttt{countrycode}} \\texttt{countrylanguage}, \\texttt{ isofficial}\\wedge \\texttt{language='French'}), \\texttt{ name\\_country}\\big)}$\n      \n\n```{.sql}\nSELECT co.name_country\nFROM country co JOIN countrylanguage l ON co.countrycode = l.countrycode\nWHERE l.isofficial AND l.language = 'French' ;\n```\n\n:::\n:::\n\n\n\n@. Quelles sont les pays où l'espagnol est langue officielle et la forme\nde gouvernement est 'Federal Republic' ? (3 lignes)\n\n    \n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n  $\\Pi\\big( \\sigma(\\texttt{country} \\bowtie_{\\texttt{countrycode}} \\texttt{countrylanguage},$\n\n  $\\texttt{ isofficial}\\wedge \\texttt{language='Spanish'}\\wedge \\texttt{governmentform='Federal Republic'}),\\texttt{ name\\_country}\\big)$\n\n\n```{.sql}\nSELECT co.name_country\nFROM country co JOIN countrylanguage l ON co.countrycode = l.countrycode\nWHERE l.isofficial AND \n      l.language = 'Spanish' AND \n      co.governmentform = 'Federal Republic' ;\n```\n\n:::\n:::\n\n\n\n@.  Quels sont les pays qui ont au moins deux langues officielles ? (38 lignes)\n\n\n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n $\\Pi\\big( \\sigma (\\texttt{country} \\bowtie_{\\texttt{countrycode}} \\texttt{l1} \\bowtie_{\\texttt{countrycode}} \\texttt{l2},$\n\n $\\texttt{ l1.isofficial}\\wedge \\texttt{l2.isofficial} \\wedge \\texttt{l1.language}\\neq \\texttt{l2.language}), \\texttt{ name\\_country}\\big)$\n\n\n```{.sql}\nSELECT DISTINCT co.name_country\nFROM \n   country AS co \n   JOIN countrylanguage AS l1 ON co.countrycode = l1.countrycode\n   JOIN countrylanguage AS l2 ON co.countrycode = l2.countrycode \n                              AND NOT (l1.language = l2.language)\nWHERE l1.isofficial AND l2.isofficial ;\n```\n\n On dispose aussi de la syntaxe $\\texttt{JOIN … USING (a}_\\texttt{1}\\texttt{,}\\dots\\texttt{,a}_\\texttt{k}\\texttt{)}$ pour\n faire des jointures naturelles qui ne considèrent que les attributs communs\n $\\texttt{a}_\\texttt{1}$ à $\\texttt{a}_\\texttt{k}$.\n\n```{.sql}\nSELECT DISTINCT name_country\nFROM country \n   JOIN countrylanguage AS l1 USING (countrycode)  \n   JOIN countrylanguage AS l2 USING (countrycode)\nWHERE l1.isofficial AND l2.isofficial AND l1.language <> l2.language ;\n```\n\n\n:::\n:::\n\n\n\n@. Quels sont les pays qui n'ont pas de langue officielle ? (49 lignes)\n    \n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n ${\\small \\Pi\\big(\\texttt{country}, \\texttt{name\\_country}\\big) -\\Pi\\big( \\sigma(\\texttt{country} \\bowtie_{\\texttt{countrycode}} \\texttt{countrylanguage} , \\texttt{isofficial}),\\texttt{name\\_country}\\big)}$\n\n```{.sql}\n(\n   SELECT name_country \n   FROM country\n)\nEXCEPT\n(\n   SELECT name_country \n   FROM country JOIN countrylanguage USING (countrycode) \n   WHERE isofficial\n);\n```\n\n:::\n:::\n\n\n\n@. Quels sont les pays qui comportent au moins deux villes de plus de 1 000 000 habitants ? (32 lignes)\n\n\n\n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n \\texttt{c1 = city}\n \n \\texttt{c2 = city}\n\n $\\Pi\\big( \\sigma(\\texttt{country} \\bowtie_{\\texttt{countrycode}} \\texttt{c1} \\bowtie_{\\texttt{countrycode}} \\texttt{c2}, \\texttt{ c1.population\\_city>1000000 }\\wedge$\n\n $\\texttt{c2.population\\_city>1000000 }\\wedge$ $\\texttt{c1.id}\\neq \\texttt{c2.id}), \\texttt{name\\_country}\\big)$\n\n```{.sql}\nSELECT DISTINCT name_country\nFROM country AS co \n   JOIN city AS c1 ON co.countrycode = c1.countrycode\n   JOIN city AS c2 ON co.countrycode = c2.countrycode AND (NOT c1.id = c2.id)\nWHERE c1.population > 1000000 AND c2.population > 1000000;\n```\n\n:::\n:::\n\n\n\n@. Quelles sont les régions qui ne comportent qu'une seule forme de gouvernement ? (3 lignes)\n\n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\n\n \\texttt{c1 = city}\n \n \\texttt{c2 = city}\n\n $\\Pi\\big( \\texttt{country } , \\texttt{ region})$\n\n $-\\ \\Pi \\big( \\sigma(\\texttt{c1} \\bowtie_{\\texttt{region}} \\texttt{c2}, \\texttt{ c1.governmentform<>c2.governmentform})\\big)$\n\n```{.sql}\n(  \n   SELECT DISTINCT region \n   FROM country\n)\nEXCEPT\n(  \n   SELECT DISTINCT c1.region \n   FROM country as c1 \n      JOIN country as c2 ON c1.region = c2.region \n                        AND c1.governmentform <> c2.governmentform\n) ;\n```\n:::\n:::\n\n\n\n@. Quelles sont les régions où on ne trouve pas de monarchie ? (9 lignes)\n\n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"Solution\"}\nLa requête algébrique a la même forme que la précédente mais nécessite d'introduire une opération `LIKE`.\n\n```{.sql}\n(  \n   SELECT region \n   FROM country\n)\nEXCEPT\n(  \n   SELECT region \n   FROM country\n   WHERE governmentform LIKE '%Monarchy%'\n) ;\n```\n\n:::\n:::\n\n",
    "supporting": [
      "td1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}