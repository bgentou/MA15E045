{
  "hash": "02edf5ec50c7cf95bd302b22f1624b9f",
  "result": {
    "engine": "knitr",
    "markdown": "---\nformat:\n  pdf:\n    code-annotations: below\n    code-fold: false\n    toc: false\n    output-file: cc2-2023-11-24.pdf\n    include-in-header:\n      - text: \"\\\\lhead{{\\\\sf  Base de données (BD5) \\\\\\\\ CC 2023-24: 2}}\"\n  html:\n    standalone: true\n    code-fold: true\n    output-file: cc2-2023-11-24.html\nparams:\n    year: 2023\n    curriculum: \"L3 MIASHS/Ingémath\"\n    university: \"Université Paris Cité\"\n    homepage: \"https://stephane-v-boucheron.fr/courses/bdd\"\n    moodle: \"https://moodle.u-paris.fr/course/view.php?id=2313\"\n---\n\n\n\n\n\n\n\n::: {layout=\"[80,20]\"}\n\n::: {#first-column}\n\n\n\n- **CC 2** 2023-11-24 16h30-18h45\n\n- **L3 MIASHS/Ingémath**\n- **[Université Paris Cité](https://www.u-paris.fr)**\n- Année 2023-2024\n- [Course Homepage](https://stephane-v-boucheron.fr/courses/bdd)  \n- [Moodle](https://moodle.u-paris.fr/course/view.php?id=2313)\n\n::: \n\n::: {#second-column}\n![](/images/UniversiteParis_monogramme_couleur_RVB.png){align=\"right\" style=\"size:50px;\" width=75}\n:::\n\n:::\n\n::: {.content-hidden when-profile=\"solution\"}\n::: {.callout-caution}\n\n- Pas de documents autorisés\n- Pas de téléphone portable \n\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n::: {.callout-tip}\nPour chaque question, proposer une requête écrite en algèbre relationnelle ou en `SQL`. \n:::\n\n\n::: {.callout-note  title=\"Question 1\"}  \n\nDans le schéma `world`, lister les pays où les dix plus grandes villes ont chacune \nau moins 10 millions d'habitants. \n\n\n:::\n\n::: {.content-visible when-profile=\"solution\"}\n\n::::: {.callout-tip title=\"Solution\"}\n\n```{.sql}\nSELECT ci.countrycode\nFROM world.city ci \nWHERE ci.population_city > 10000000\nGROUP BY ci.countrycode \nHAVING COUNT(ci.id) >= 10 ;\n```\n\n:::::\n\n:::\n\n\n::: {.callout-note  title=\"Question 2\"}  \n\nDans le schéma `world`, pour chaque pays, donner les trois langues les plus parlées.  \n \n:::\n\n::: {.content-visible when-profile=\"solution\"}\n\n::::: {.callout-tip title=\"Solution\"}\n\n\n```{.sql}\nWITH R AS (\n  SELECT cl.countrycode, cl.language, RANK()   OVER w AS rnk \n  FROM world.countrylanguage cl \n  WINDOW w AS (PARTITION BY cl.countrycode ORDER   BY cl.percentage DESC)\n)\n\nSELECT R.countrycode, R.language\nFROM R\nWHERE R.rnk <= 3 ;\n```\n\n:::::\n\n:::\n\n\n::: {.callout-note  title=\"Question 3\"}  \n\nDans le schéma `world`, lister les langues parlées sur tous les continents. \n\n:::\n\n\n::: {.content-visible when-profile=\"solution\"}\n\n::::: {.callout-tip title=\"Solution\"}\n\n\n```{.sql}\n\n```\n\n:::::\n\n:::\n\n::: {.callout-note  title=\"Question 4\"}  \n\n\nDans le schéma `world`, lister par région le nombre de langues officielles distinctes.\n\n\n:::\n\n\n::: {.content-visible when-profile=\"solution\"}\n\n::::: {.callout-tip title=\"Solution\"}\n\n\n```{.sql}\nSELECT co.region, COUNT(DISTINCT cl.language) AS n\nFROM world.countrylanguage cl NATURAL JOIN world.country co \nWHERE cl.isofficial\nGROUP BY co.region\n```\n\n:::::\n\n:::\n\n\n::: {.callout-note  title=\"Question 5\"}  \n\nDans le schéma `world`, lister pour chaque forme de gouvernement, la population des villes des pays qui subissent cette forme de gouvernement.\n\n\n:::\n\n\n::: {.content-visible when-profile=\"solution\"}\n\n::::: {.callout-tip title=\"Solution\"}\n\n\n```{.sql}\nSELECT co.governmentform, SUM(ci.population_city) AS pop\nFROM world.country co JOIN world.city ci \n  ON (co.countrycode=ci.countrycode)\nGROUP BY co.governmentform ;\n```\n\n:::::\n\n:::\n\n\n\n::: {.callout-note  title=\"Question 6\"}  \n\nDans le schéma `world`, lister les pays où la capitale est \nla ville la plus peuplée.\n\n\n:::\n\n\n::: {.content-visible when-profile=\"solution\"}\n\n::::: {.callout-tip title=\"Solution\"}\n\n\n```{.sql}\nWITH R AS (\n  SELECT  co.country, ci.id, ci.population_city\n  FROM world.country co JOIN world.city ci \n  ON (co.capital=ci.id)\n)\n\nSELECT R.countrycode, R.id, \nFROM R co JOIN world.city ci \n  ON (co.countrycode=ci.countrycode)\nGROUP BY R.id, R.countrycode \nHAVING co.population_city >= MAX(ci.population_city);\n```\n\n:::::\n\n:::\n\n\n::: {.callout-note  title=\"Question 7\"}  \n\nDans le schéma `world`, lister les pays où $90\\%$ de la population\nparle une langue officielle (il peut y avoir plusieurs langues\nofficielles, dont la somme des locuteurs et locutrices dépasse\n$90\\%$ de la population).\n\n\n:::\n\n::: {.content-visible when-profile=\"solution\"}\n\n::::: {.callout-tip title=\"Solution\"}\n\n\n```{.sql}\nSELECT cl.countrycode\nFROM world.countrylanguage cl \nWHERE cl.isofficial\nGROUP BY cl.countrycode\nHAVING SUM(cl.percentage) >= 90 ;\n```\n\n:::::\n\n:::\n\n\n\n\n\n{{< pagebreak >}}\n\n\n\n\n\n\n\nToutes les questions portent sur le schéma `world`.\n\n\n![Schéma `world`](/images/world.png){width=8cm}\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}